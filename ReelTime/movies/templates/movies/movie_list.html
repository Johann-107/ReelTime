{% extends 'reel_time/partials/base.html' %}

{% load static %}

{% block title %}All Movies - ReelTime{% endblock title %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/movie_list.css' %}">
{% endblock extra_head %}

{% block content %}
    <main class="page-content">
        <div class="container">
            <h1 class="page-title">All Movies</h1>

            <div class="search-filter-bar">
                <div class="search-wrapper">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="search" id="movieSearch" placeholder="Search movies..." class="search-input">
                </div>
                <select id="genreFilter" class="filter-select">
                    <option value="all">All Genres</option>
                    <option value="action">Action</option>
                    <option value="adventure">Adventure</option>
                    <option value="thriller">Thriller</option>
                    <option value="sci-fi">Sci-Fi</option>
                    <option value="romance">Romance</option>
                    <option value="comedy">Comedy</option>
                </select>
            </div>
            
            <div class="movie-grid">
                {% for movie in movies %}
                    {% with detail=movie.detail %}
                        <div class="movie-card">
                            {% if user.is_authenticated and user.is_admin %}
                                <a href="{% url 'movie_detail' movie.detail.pk %}" class="movie-link">
                                    <h3>{{ movie.detail.movie.title }}</h3>
                                </a>
                            {% else %}
                                <h3>{{ movie.detail.movie.title }}</h3>
                            {% endif %}
                            
                            {% if detail.poster %}
                                <img src="{{ detail.poster.url }}" alt="{{ detail.movie.title }} Poster" class="movie-poster">
                            {% else %}
                                <img src="{% static 'images/default_poster.jpg' %}" alt="No poster available" class="movie-poster">
                            {% endif %}

                            <p><strong>Duration:</strong> {{ detail.movie.duration_minutes }} minutes</p>
                            <p><strong>Showtimes:</strong> {{ movie.showing_times_display }}</p>
                            <p><strong>Release Date:</strong> {{ movie.release_label }}</p>
                            <p><strong>End Date:</strong> {{ movie.end_date }}</p>
                        </div>
                    {% endwith %}
                {% endfor %}
            </div>

        </div>
    </main>
{% endblock content %}

{% block extra_js %}
    <script>
        const STATIC_URL = "{% static '' %}";
    </script>
    <script src="{% static 'js/script.js' %}"></script>
    <script src="{% static 'js/movies.js' %}"></script>
{% endblock extra_js %}