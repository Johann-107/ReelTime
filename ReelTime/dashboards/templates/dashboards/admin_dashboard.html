{% extends 'reel_time/partials/base.html' %} 
{% load static %} 

{# 1. PAGE TITLE BLOCK #}
{% block title %}
¬† ¬† Admin Dashboard - ReelTime
{% endblock title %}

---

{# 2. PAGE-SPECIFIC CSS BLOCK #}
{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}">
{% endblock extra_head %}

---

{# 3. MAIN CONTENT BLOCK #}
{% block content %}
<div class="page-content">
    <div class="container">
        
        {# 1. Welcome Banner #}
        <div class="welcome-banner">
            <div class="welcome-content">
                <h1 class="welcome-title">Welcome, {{ user.username|default:"Admin" }}! üõ†Ô∏è</h1>
                <p class="welcome-subtitle">
                    {% if user.cinema_name %}
                        Managing {{ user.cinema_name }} | 
                    {% endif %}
                    Control your movies, showtimes, and reservations
                </p>
            </div>
            
            {# Statistics Cards #}
            <div class="welcome-stats">
                <div class="stat-card">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 20h9"></path><path d="M16.5 3.5l-3 3"></path><path d="M17.5 15H9l-3 3l-3-3V9l3-3h8a2 2 0 012 2v2"></path>
                    </svg>
                    <div class="stat-info">
                        <span class="stat-number">{{ movies_count|default:"0" }}</span>
                        <span class="stat-label">Total Movies</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 11l3 3L22 4"></path>
                        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                    </svg>
                    <div class="stat-info">
                        <span class="stat-number">{{ reservations_count|default:"0" }}</span>
                        <span class="stat-label">Total Reservations</span>
                    </div>
                </div>
            </div>
        </div>

        {# 2. Admin Tools Section #}
        <div class="section-header">
            <h2 class="section-title">Admin Tools</h2>
            <div class="title-underline"></div>
        </div>
        
        <div class="movie-grid">
            
            {# Action Card: Add New Movie (Primary Action) #}
            <div class="movie-card">
                <div class="movie-content">
                    <h3 class="movie-title">Add New Movie</h3>
                    <p class="text-muted" style="margin-bottom: 1.5rem;">Upload details and poster for a new cinematic release.</p>
                    <a href="{% url 'add_movie' %}" class="btn-reserve">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span>Add Movie</span>
                    </a>
                </div>
            </div>
            
            {# Action Card: Manage Movies (Secondary Action) #}
            <div class="movie-card">
                <div class="movie-content">
                    <h3 class="movie-title">Manage Movies</h3>
                    <p class="text-muted" style="margin-bottom: 1.5rem;">Edit or remove existing movie entries and showtimes.</p>
                    <a href="{% url 'movie_list' %}" class="btn-reserve btn-secondary-action">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                        <span>Edit Movies</span>
                    </a>
                </div>
            </div>
            
            {# Action Card: Account Settings (Secondary Action) #}
            <div class="movie-card">
                <div class="movie-content">
                    <h3 class="movie-title">Account Settings</h3>
                    <p class="text-muted" style="margin-bottom: 1.5rem;">Update administrator password and personal details.</p>
                    <a href="{% url 'change_password' %}" class="btn-reserve btn-secondary-action">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Change Password</span>
                    </a>
                </div>
            </div>
            
        </div>

        {# 3. Recent Reservations Section #}
        <div class="section-header" style="margin-top: 3rem;">
            <h2 class="section-title">Recent Reservations</h2>
            <div class="title-underline"></div>
        </div>

        {% if recent_reservations %}
            <div class="reservations-table-container">
                <table class="reservations-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Movie</th>
                            <th>Reserved Date</th>
                            <th>Showtime</th>
                            <th>Seats</th>
                            <th>Booking Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for reservation in recent_reservations %}
                            <tr>
                                <td>
                                    <div class="user-info">
                                        <strong>{{ reservation.user.get_full_name|default:reservation.user.username }}</strong>
                                        <br><small>{{ reservation.user.email }}</small>
                                    </div>
                                </td>
                                <td><strong>{{ reservation.movie_detail.movie.title }}</strong></td>
                                <td>{{ reservation.selected_date|date:"M d, Y" }}</td>
                                <td>{{ reservation.selected_showtime }}</td>
                                <td class="text-center">{{ reservation.number_of_seats }}</td>
                                <td>{{ reservation.reservation_date|date:"M d, Y g:i A" }}</td>
                                <td>
                                    {% if reservation.status == 'pending' %}
                                        <span class="badge badge-warning">Pending</span>
                                    {% elif reservation.status == 'confirmed' %}
                                        <span class="badge badge-success">Confirmed</span>
                                    {% elif reservation.status == 'cancelled' %}
                                        <span class="badge badge-danger">Cancelled</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="{% url 'reservations' %}" class="btn-reserve btn-secondary-action">View All Reservations</a>
                </div>
            </div>
        {% else %}
            <div class="empty-state" style="text-align: center; padding: 3rem;">
                <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 64px; height: 64px; margin: 0 auto 1rem; opacity: 0.5;">
                    <path d="M9 11l3 3L22 4"></path>
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                </svg>
                <h3>No Reservations Yet</h3>
                <p class="text-muted">Your movies don't have any reservations yet.</p>
            </div>
        {% endif %}

    </div>
</div>
{% endblock content %}

{% block extra_js %}
{# All styles moved to static/css/admin_dashboard.css #}
{% endblock extra_js %}
